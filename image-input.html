<link rel="import" href="../polymer/polymer-element.html">

<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/image-icons.html">
<link rel="import" href="../paper-ripple/paper-ripple.html">
<!--
`file-input` is a input for images. Render a custom input file and return the file choosed

Example:

    <image-input></image-input>

### Styling

Style the button with CSS as you would a normal DOM element.

    paper-button.fancy {
      background: green;
      color: yellow;
    }

    paper-button.fancy:hover {
      background: lime;
    }

    paper-button[disabled],
    paper-button[toggles][active] {
      background: red;
    }

By default, the ripple is the same color as the foreground at 25% opacity. You may
customize the color using the `--paper-button-ink-color` custom property.

The following custom properties and mixins are also available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--image-input-width` | Width of viewer image | `128px`
`--image-input-height` | Height of viewer image | `128px`
`--image-input-radius` | Radios applied for image style | `50%`
`--image-input-background` | style for background | ``
`--image-input-background-hover` | Style applied when hover | ``

@demo demo/index.html
-->

<dom-module id="image-input">
  <template>
    <style is="custom-style">
      :host {
        display: block;
      }

      .image {
        width: var(--image-input-width, 128px);
        height: var(--image-input-height, 128px);
        border-radius: var(--image-input-radius, 50%);
        background: var(--image-input-background);
        background-position: center;
        background-size: 100%;
        position: relative;

        @apply --layout-vertical;
        @apply --layout-center-center;
      }
      
      .image:hover {
        background: var(--image-input-background-hover);
        cursor: pointer;
      }

      .image:hover iron-icon{
        display: block;
      }

      iron-icon {
        display: none;
        color: white;
        --iron-icon-width: 40%;
        --iron-icon-height: 40%;
      }
    </style>
    <file-input on-changed-files="_pickImage" required="[[required]]">
      <div slot="input-button" class="image">
        <paper-ripple></paper-ripple>
        <iron-icon icon="image:camera-alt"></iron-icon>
      </div>
    </file-input>
  </template>
  <script>
    class ImageInput extends Polymer.Element {
      static get is() {return 'image-input';}

      static get properties() {
        return {
          /**
           * icon applied when hover, default image:camera-alt
           */
          icon: {
            type: String,
            value: 'image:camera-alt',
          },
          /**
           * default image for background when is no image selected
           */
          defaultImage: {
            type: String,
          },

          /**
           * name for form
           */
          name: {
            type: String,
          },
          /*
           * file selected
           */
          value: {
            type: String,
          },
        };
      }

      _pickImage(event, detail) {
        if (detail.length > 0) {
          const image = window.URL.createObjectURL(detail.item(0));
          this.updateStyles({
            '--image-input-background': `url('${image}')`,
            '--image-input-background-hover':
              `linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.45)),
              url('${image}')`,
          });
          this.set('value', image);
        }
      }

      /**
       * Validate whether is required
       */
      validate() {
        if (this.required) {
          return this.value ? true : false;
        }
        return true;
      }
    }
    window.customElements.define(ImageInput.is, ImageInput);
  </script>
</dom-module>